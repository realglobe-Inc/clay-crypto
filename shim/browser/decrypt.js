/**
 * Decrypt text
 * @function decrypt
 * @param {string} text - Cipher string to be decrypted.
 * @param {RSAKey} rsaKey - - RSAKey object of the recipient.
 * @returns {Object} - Decrypted text
 */
'use strict';

var _require = require('cryptico');

var doDecrypt = _require.decrypt;

var _require2 = require('clay-constants');

var LogPrefixes = _require2.LogPrefixes;
var CRYPTO_PREFIX = LogPrefixes.CRYPTO_PREFIX;

/** @lends decrypt */

function decrypt(text, rsaKey) {
  var _doDecrypt = doDecrypt(text, rsaKey);

  var status = _doDecrypt.status;
  var plaintext = _doDecrypt.plaintext;

  if (status !== 'success') {
    throw new Error(CRYPTO_PREFIX + ' Decrypt failed');
  }
  return plaintext;
}

module.exports = decrypt;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlY3J5cHQuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImRvRGVjcnlwdCIsImRlY3J5cHQiLCJMb2dQcmVmaXhlcyIsIkNSWVBUT19QUkVGSVgiLCJ0ZXh0IiwicnNhS2V5Iiwic3RhdHVzIiwicGxhaW50ZXh0IiwiRXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQU9BOztlQUUrQkEsUUFBUSxVQUFSLEM7O0lBQWRDLFMsWUFBVEMsTzs7Z0JBQ2dCRixRQUFRLGdCQUFSLEM7O0lBQWhCRyxXLGFBQUFBLFc7SUFDQUMsYSxHQUFrQkQsVyxDQUFsQkMsYTs7QUFFUjs7QUFDQSxTQUFTRixPQUFULENBQWtCRyxJQUFsQixFQUF3QkMsTUFBeEIsRUFBZ0M7QUFBQSxtQkFDRkwsVUFBVUksSUFBVixFQUFnQkMsTUFBaEIsQ0FERTs7QUFBQSxNQUN4QkMsTUFEd0IsY0FDeEJBLE1BRHdCO0FBQUEsTUFDaEJDLFNBRGdCLGNBQ2hCQSxTQURnQjs7QUFFOUIsTUFBSUQsV0FBVyxTQUFmLEVBQTBCO0FBQ3hCLFVBQU0sSUFBSUUsS0FBSixDQUFhTCxhQUFiLHFCQUFOO0FBQ0Q7QUFDRCxTQUFPSSxTQUFQO0FBQ0Q7O0FBRURFLE9BQU9DLE9BQVAsR0FBaUJULE9BQWpCIiwiZmlsZSI6ImRlY3J5cHQuanMiLCJzb3VyY2VSb290IjoibGliIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZWNyeXB0IHRleHRcbiAqIEBmdW5jdGlvbiBkZWNyeXB0XG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIENpcGhlciBzdHJpbmcgdG8gYmUgZGVjcnlwdGVkLlxuICogQHBhcmFtIHtSU0FLZXl9IHJzYUtleSAtIC0gUlNBS2V5IG9iamVjdCBvZiB0aGUgcmVjaXBpZW50LlxuICogQHJldHVybnMge09iamVjdH0gLSBEZWNyeXB0ZWQgdGV4dFxuICovXG4ndXNlIHN0cmljdCdcblxuY29uc3QgeyBkZWNyeXB0OiBkb0RlY3J5cHQgfSA9IHJlcXVpcmUoJ2NyeXB0aWNvJylcbmNvbnN0IHsgTG9nUHJlZml4ZXMgfSA9IHJlcXVpcmUoJ2NsYXktY29uc3RhbnRzJylcbmNvbnN0IHsgQ1JZUFRPX1BSRUZJWCB9ID0gTG9nUHJlZml4ZXNcblxuLyoqIEBsZW5kcyBkZWNyeXB0ICovXG5mdW5jdGlvbiBkZWNyeXB0ICh0ZXh0LCByc2FLZXkpIHtcbiAgbGV0IHsgc3RhdHVzLCBwbGFpbnRleHQgfSA9IGRvRGVjcnlwdCh0ZXh0LCByc2FLZXkpXG4gIGlmIChzdGF0dXMgIT09ICdzdWNjZXNzJykge1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtDUllQVE9fUFJFRklYfSBEZWNyeXB0IGZhaWxlZGApXG4gIH1cbiAgcmV0dXJuIHBsYWludGV4dFxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGRlY3J5cHRcbiJdfQ==