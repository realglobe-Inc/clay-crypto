/**
 * Create sign
 * @function sign
 * @param {string} text - String to be encrypted.
 * @param {RSAKey} signingKey - RSAKey object of the sender.
 * @returns {string}
 */
'use strict';

var _require = require('cryptico');

var b16to64 = _require.b16to64;

var _require2 = require('clay-constants');

var CryptFormat = _require2.CryptFormat;
var DIGEST_ALGORITHM = CryptFormat.DIGEST_ALGORITHM;

/** @lends sign */

function sign(plaintext, signingKey) {
  var options = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];
  var _options$algorithm = options.algorithm;
  var algorithm = _options$algorithm === undefined ? DIGEST_ALGORITHM : _options$algorithm;

  return b16to64(signingKey.signString(plaintext, algorithm));
}

module.exports = sign;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNpZ24uanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImIxNnRvNjQiLCJDcnlwdEZvcm1hdCIsIkRJR0VTVF9BTEdPUklUSE0iLCJzaWduIiwicGxhaW50ZXh0Iiwic2lnbmluZ0tleSIsIm9wdGlvbnMiLCJhbGdvcml0aG0iLCJzaWduU3RyaW5nIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFPQTs7ZUFFb0JBLFFBQVEsVUFBUixDOztJQUFaQyxPLFlBQUFBLE87O2dCQUNnQkQsUUFBUSxnQkFBUixDOztJQUFoQkUsVyxhQUFBQSxXO0lBQ0FDLGdCLEdBQXFCRCxXLENBQXJCQyxnQjs7QUFFUjs7QUFDQSxTQUFTQyxJQUFULENBQWVDLFNBQWYsRUFBMEJDLFVBQTFCLEVBQW9EO0FBQUEsTUFBZEMsT0FBYyx5REFBSixFQUFJO0FBQUEsMkJBQ1hBLE9BRFcsQ0FDNUNDLFNBRDRDO0FBQUEsTUFDNUNBLFNBRDRDLHNDQUNoQ0wsZ0JBRGdDOztBQUVsRCxTQUFPRixRQUFRSyxXQUFXRyxVQUFYLENBQXNCSixTQUF0QixFQUFpQ0csU0FBakMsQ0FBUixDQUFQO0FBQ0Q7O0FBRURFLE9BQU9DLE9BQVAsR0FBaUJQLElBQWpCIiwiZmlsZSI6InNpZ24uanMiLCJzb3VyY2VSb290IjoibGliIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGUgc2lnblxuICogQGZ1bmN0aW9uIHNpZ25cbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0gU3RyaW5nIHRvIGJlIGVuY3J5cHRlZC5cbiAqIEBwYXJhbSB7UlNBS2V5fSBzaWduaW5nS2V5IC0gUlNBS2V5IG9iamVjdCBvZiB0aGUgc2VuZGVyLlxuICogQHJldHVybnMge3N0cmluZ31cbiAqL1xuJ3VzZSBzdHJpY3QnXG5cbmNvbnN0IHsgYjE2dG82NCB9ID0gcmVxdWlyZSgnY3J5cHRpY28nKVxuY29uc3QgeyBDcnlwdEZvcm1hdCB9ID0gcmVxdWlyZSgnY2xheS1jb25zdGFudHMnKVxuY29uc3QgeyBESUdFU1RfQUxHT1JJVEhNIH0gPSBDcnlwdEZvcm1hdFxuXG4vKiogQGxlbmRzIHNpZ24gKi9cbmZ1bmN0aW9uIHNpZ24gKHBsYWludGV4dCwgc2lnbmluZ0tleSwgb3B0aW9ucyA9IHt9KSB7XG4gIGxldCB7IGFsZ29yaXRobSA9IERJR0VTVF9BTEdPUklUSE0gfSA9IG9wdGlvbnNcbiAgcmV0dXJuIGIxNnRvNjQoc2lnbmluZ0tleS5zaWduU3RyaW5nKHBsYWludGV4dCwgYWxnb3JpdGhtKSlcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzaWduXG4iXX0=