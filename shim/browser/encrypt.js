/**
 * Encrypt text
 * @function encrypt
 * @param {string} text - String to be encrypted.
 * @param {string} publicKey - Public key string of the recipient.
 * @param {RSAKey} signingKey - RSAKey object of the sender.
 * @returns {Object} - Encrypted text
 */
'use strict';

var _require = require('cryptico');

var doEncrypt = _require.encrypt;

var _require2 = require('clay-constants');

var LogPrefixes = _require2.LogPrefixes;
var CRYPTO_PREFIX = LogPrefixes.CRYPTO_PREFIX;

/** @lends encrypt */

function encrypt(text, publicKey, signingKey) {
  var _doEncrypt = doEncrypt(text, publicKey, signingKey);

  var status = _doEncrypt.status;
  var cipher = _doEncrypt.cipher;

  if (status !== 'success') {
    throw new Error(CRYPTO_PREFIX + ' Encrypt failed');
  }
  return cipher;
}

module.exports = encrypt;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuY3J5cHQuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImRvRW5jcnlwdCIsImVuY3J5cHQiLCJMb2dQcmVmaXhlcyIsIkNSWVBUT19QUkVGSVgiLCJ0ZXh0IiwicHVibGljS2V5Iiwic2lnbmluZ0tleSIsInN0YXR1cyIsImNpcGhlciIsIkVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7O0FBUUE7O2VBRStCQSxRQUFRLFVBQVIsQzs7SUFBZEMsUyxZQUFUQyxPOztnQkFDZ0JGLFFBQVEsZ0JBQVIsQzs7SUFBaEJHLFcsYUFBQUEsVztJQUNBQyxhLEdBQWtCRCxXLENBQWxCQyxhOztBQUVSOztBQUNBLFNBQVNGLE9BQVQsQ0FBa0JHLElBQWxCLEVBQXdCQyxTQUF4QixFQUFtQ0MsVUFBbkMsRUFBK0M7QUFBQSxtQkFDcEJOLFVBQVVJLElBQVYsRUFBZ0JDLFNBQWhCLEVBQTJCQyxVQUEzQixDQURvQjs7QUFBQSxNQUN2Q0MsTUFEdUMsY0FDdkNBLE1BRHVDO0FBQUEsTUFDL0JDLE1BRCtCLGNBQy9CQSxNQUQrQjs7QUFFN0MsTUFBSUQsV0FBVyxTQUFmLEVBQTBCO0FBQ3hCLFVBQU0sSUFBSUUsS0FBSixDQUFhTixhQUFiLHFCQUFOO0FBQ0Q7QUFDRCxTQUFPSyxNQUFQO0FBQ0Q7O0FBRURFLE9BQU9DLE9BQVAsR0FBaUJWLE9BQWpCIiwiZmlsZSI6ImVuY3J5cHQuanMiLCJzb3VyY2VSb290IjoibGliIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFbmNyeXB0IHRleHRcbiAqIEBmdW5jdGlvbiBlbmNyeXB0XG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIFN0cmluZyB0byBiZSBlbmNyeXB0ZWQuXG4gKiBAcGFyYW0ge3N0cmluZ30gcHVibGljS2V5IC0gUHVibGljIGtleSBzdHJpbmcgb2YgdGhlIHJlY2lwaWVudC5cbiAqIEBwYXJhbSB7UlNBS2V5fSBzaWduaW5nS2V5IC0gUlNBS2V5IG9iamVjdCBvZiB0aGUgc2VuZGVyLlxuICogQHJldHVybnMge09iamVjdH0gLSBFbmNyeXB0ZWQgdGV4dFxuICovXG4ndXNlIHN0cmljdCdcblxuY29uc3QgeyBlbmNyeXB0OiBkb0VuY3J5cHQgfSA9IHJlcXVpcmUoJ2NyeXB0aWNvJylcbmNvbnN0IHsgTG9nUHJlZml4ZXMgfSA9IHJlcXVpcmUoJ2NsYXktY29uc3RhbnRzJylcbmNvbnN0IHsgQ1JZUFRPX1BSRUZJWCB9ID0gTG9nUHJlZml4ZXNcblxuLyoqIEBsZW5kcyBlbmNyeXB0ICovXG5mdW5jdGlvbiBlbmNyeXB0ICh0ZXh0LCBwdWJsaWNLZXksIHNpZ25pbmdLZXkpIHtcbiAgbGV0IHsgc3RhdHVzLCBjaXBoZXIgfSA9IGRvRW5jcnlwdCh0ZXh0LCBwdWJsaWNLZXksIHNpZ25pbmdLZXkpXG4gIGlmIChzdGF0dXMgIT09ICdzdWNjZXNzJykge1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtDUllQVE9fUFJFRklYfSBFbmNyeXB0IGZhaWxlZGApXG4gIH1cbiAgcmV0dXJuIGNpcGhlclxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGVuY3J5cHRcbiJdfQ==